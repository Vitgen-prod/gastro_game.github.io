/* ========== BASE ========== */
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial}
:root{
  --menu-bg:#EEEBDD;--menu-shadow:0 10px 30px rgba(0,0,0,.12);
  --menu-radius:18px;--menu-divider:#F4F0E8;--menu-text:#4b5656;
}

/* ========== START ========== */
.container{position:fixed;inset:0;background:url('фон11.png') center/cover no-repeat}
.header,.title,.logo{display:none!important}
.action{position:absolute;bottom:max(32px,env(safe-area-inset-bottom));left:50%;transform:translateX(-50%)}
.start-image-btn{display:block;width:342px;height:60px;cursor:pointer}

/* ========== APP ========== */
.hidden{display:none!important}
.app{position:fixed;inset:0;display:flex;flex-direction:column;background:url('фон2.png') center/cover no-repeat}

/* ========== MAP ========== */
.map{position:relative;flex:1;padding:8px 12px}
.map-canvas{position:relative;margin-top:0;border-radius:18px;overflow:hidden;min-height:520px;background:rgba(255,255,255,.55)}
.lvl{position:absolute;display:flex;align-items:center;justify-content:center;width:56px;height:56px;border-radius:50%;background:#fff;box-shadow:0 6px 18px rgba(0,0,0,.14);font-weight:700;color:#333;border:2px solid #fff;cursor:pointer}
.lvl[data-level="1"]{left:18px;top:40px}.lvl[data-level="2"]{right:26px;top:150px}
.lvl[data-level="3"]{left:34px;bottom:160px}.lvl[data-level="4"]{right:22px;bottom:60px}
.lvl .sub{position:absolute;bottom:-18px;background:#fff;border-radius:999px;padding:2px 8px;font-size:11px;box-shadow:0 3px 10px rgba(0,0,0,.08)}

.cta{position:sticky;bottom:10px;margin-top:10px}
.btn{width:100%;height:56px;border:0;border-radius:14px;background:#3a3f3f;color:#fff;font-size:16px;font-weight:700;letter-spacing:.2px;box-shadow:0 8px 20px rgba(0,0,0,.18);cursor:pointer}

/* ========== BOTTOM NAV ========== */
.bottom-card{position:fixed;left:50%;transform:translateX(-50%);bottom:max(8px,env(safe-area-inset-bottom));width:calc(100% - 24px);max-width:420px;display:flex;align-items:center;justify-content:space-between;background:var(--menu-bg);border-radius:var(--menu-radius);box-shadow:var(--menu-shadow);padding:12px 10px;backdrop-filter:blur(4px);z-index:60}
.bottom-card .tab{appearance:none;-webkit-appearance:none;border:0;background:transparent;cursor:pointer;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:6px 8px;flex:1;min-width:0;text-align:center}
.bottom-card .tab .icon{width:32px;height:32px;object-fit:contain;display:block}
.bottom-card .tab span{font-size:13px;line-height:1.2;text-align:center;font-weight:600;color:var(--menu-text)}
.bottom-card .divider{width:1px;height:30px;background:var(--menu-divider);display:block;opacity:.9}
.bottom-card .tab:active{transform:scale(.96)}

/* ========== POPUP ========== */
.overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:1000;overflow:auto}
.popup{position:relative;width:90%;max-width:360px;margin:24px 0}
.popup-title{position:absolute;top:-22px;left:50%;transform:translateX(-50%);width:calc(100% - 32px);max-width:340px;height:auto;display:block;z-index:5;margin:0}
.popup-bg{width:100%;display:block;z-index:1}
.popup-content{position:absolute;top:45px;left:0;right:0;padding:20px 20px 88px;display:flex;flex-direction:column;align-items:center;gap:6px;z-index:2}
.popup-content img{max-width:90%;height:auto}
.popup-content img:nth-child(1){margin-top:-20px}
.popup-content img:nth-child(2){margin-top:35px}
.popup-content img:nth-child(3){margin-top:10px}
.popup-btn{position:absolute;left:50%;bottom:20px;transform:translateX(-50%);background:#FFBBCE;border:0;border-radius:38px;padding:8px 30px;font-family:'Manrope',sans-serif;font-size:16px;font-weight:700;line-height:1;text-transform:uppercase;text-align:center;color:#fff;z-index:5;box-shadow:0 8px 20px rgba(0,0,0,.15)}
.popup-btn:active{transform:translateX(-50%) scale(.98)}

/* ========== STATUS CARD (fixed top) ========== */
.status-card{
  position:fixed;z-index:50;
  top:calc(env(safe-area-inset-top) + 12px);
  left:50%;transform:translateX(-50%);
  width:342px;background:#fff;border-radius:16px;
  box-shadow:0 2px 20px rgba(72,79,76,.20);padding:12px;
}
.status-row{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:10px}
.status-card .chip{display:inline-flex;align-items:center;justify-content:center;white-space:nowrap;flex:none;height:32px;font-weight:700;font-size:14px;padding:4px 12px;border-radius:20px}
.status-card .chip.gray{background:#EEEBDD;color:#484F4C;border-radius:27px;padding:10px 16px;height:52px}
.status-card .chip.pink{background:#FFBBCE;color:#fff}
.status-card .chip.green{background:#79A57B;color:#fff}
.status-card .progress-title{display:block;margin-bottom:6px;font-family:'Manrope',sans-serif;font-weight:700;font-size:16px;color:#484F4C}
.status-card .progress-rail{display:flex;align-items:center;gap:8px;padding:6px;border-radius:14px;background:#fff;border:1px solid #FFBBCE}
.status-card .progress-rail .seg{flex:1;height:12px;border-radius:12px;background:#fff;border:1px solid #FFBBCE}
.status-card .progress-rail .seg.on{background:#FFBBCE}

/* чтобы контент не прятался под фиксированным статусом */
.map,#shopScreen{padding-top:240px}

/* ========== SHOP (fixed title + grid) ========== */
.shop-top{position:fixed;top:0;left:0;right:0;z-index:45;pointer-events:none}
.shop-title-img{position:fixed;z-index:55;top:calc(env(safe-area-inset-top) + 150px);left:50%;transform:translateX(-50%);width:114px;height:69px;object-fit:contain;pointer-events:auto}

#shopScreen{position:relative;padding-bottom:120px}
.shop-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;padding:0 16px 120px;margin-top:28px}

/* карточка магазина */
.shop-card{position:relative;min-height:160px;border-radius:16px;overflow:hidden;padding:14px 14px 18px;background:#F4F4F4;background-size:cover;background-position:center;box-shadow:0 2px 10px rgba(0,0,0,.06);cursor:pointer}
.shop-card.lv1{background-image:url('card-lv1.png')}
.shop-card.lv2{background-image:url('card-lv2.png')}
.shop-card.lv3{background-image:url('card-lv3.png')}
.shop-card.lv4{background-image:url('card-lv4.png')}
.shop-card.locked{filter:grayscale(1) contrast(.9) brightness(.9);cursor:default}
.shop-card.locked::after{content:"";position:absolute;inset:0;background:rgba(0,0,0,.12)}

/* проценты + подпись над прогрессом */
.shop-meta{display:flex;align-items:baseline;gap:6px;color:#2b2f2e;text-shadow:0 1px 0 rgba(255,255,255,.6)}
.shop-percent{font-weight:800;font-size:22px;line-height:1}
.shop-label{font-weight:600;font-size:14px;opacity:.9}

/* прогресс внизу карточки */
.shop-progress{position:absolute;left:14px;right:14px;bottom:14px;height:12px;border-radius:999px;background:rgba(0,0,0,.06);overflow:hidden}
.shop-fill{display:block;height:100%;width:0%;background:#79A57B;transition:width .45s ease}
